{"ast":null,"code":"// import React from 'react'\n// import '../styles/tour-card.css'\n// import { Card, CardBody } from 'reactstrap'\n// import { Link } from 'react-router-dom'\n// import calculateAvgRating from '../utils/avgRating'\n// import { priceWithDiscount } from '../utils/price'\n// import { BASE_URL } from \"../utils/config\";\n// const TourCard = ({tour}) => {\n//   const toggleWishlist = async (e) => {\n//     e.preventDefault();\n//     e.stopPropagation();\n//     const token = localStorage.getItem(\"token\");\n//     try{\n//       await fetch(`${BASE_URL}/wishlist/toggle`, {\n//         method: \"POST\",\n//         headers: { \"Content-Type\":\"application/json\", Authorization: `Bearer ${token}` },\n//         body: JSON.stringify({ tourId: tour._id })\n//       });\n//       // naive UI feedback\n//       alert(\"Wishlist updated\");\n//     }catch(err){ console.error(err); }\n//   };\n//     const {_id,title,city,photo,price, featured, reviews}=tour;\n// const {totalRating,avgRating} = calculateAvgRating(reviews)\n//   return (\n//     <div className='tour__card'>\n//       <Card>\n//         <div className=\"tour__img\">\n//             <img src={photo} alt=\"tour-img\" />\n//             { featured && <span>Featured</span>}\n//         </div>\n//         <CardBody>\n//         <div className=\"card__top d-flex align-items-center justify-content-between\">\n//             <span className='tour__location d-flex align-items-center gap-1'>\n//             <i className=\"ri-map-pin-line\"></i> {city}\n//             </span>\n//             <span className='tour__rating d-flex align-items-center gap-1'>\n//             <i className=\"ri-star-fill\"></i>{avgRating === 0 ? null :avgRating} \n//             {totalRating === 0 ? ('Not rated'):(\n//               <span>({reviews.length})</span>\n//               )}\n//             </span>\n//         </div>\n//         <h5 className='tour__title'><Link to={`/tours/${_id}`}>{title}</Link></h5>\n//         <div className=\"card__bottom d-flex align-items-center justify-content-between mt-3\">\n//             <h5>{priceWithDiscount(tour.price, tour.discountPercent).original ? (`${priceWithDiscount(tour.price, tour.discountPercent).final}`) : `${tour.price}`} <span>/per person</span></h5>\n//             <button className=\"btn booking__btn\">\n//                 <Link to={`/tours/${_id}`}>Book Now</Link>\n//             </button>\n//         </div>\n//       <button className=\"btn secondary__btn w-100 mt-2\" onClick={toggleWishlist}>♥ Save</button>\n// </CardBody>\n//       </Card>\n//     </div>\n//   )\n// }\n// export default TourCard\nimport React,{useState,useEffect}from'react';import'../styles/tour-card.css';import{Card,CardBody}from'reactstrap';import{Link}from'react-router-dom';import calculateAvgRating from'../utils/avgRating';import{priceWithDiscount}from'../utils/price';import{BASE_URL}from\"../utils/config\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const TourCard=_ref=>{let{tour}=_ref;const[isSaved,setIsSaved]=useState(false);// ✅ Check if this tour is already in wishlist when component loads\nuseEffect(()=>{const token=localStorage.getItem(\"token\");if(!token)return;fetch(\"\".concat(BASE_URL,\"/wishlist\"),{headers:{Authorization:\"Bearer \".concat(token)}}).then(res=>res.json()).then(data=>{var _data$tours;if(data!==null&&data!==void 0&&(_data$tours=data.tours)!==null&&_data$tours!==void 0&&_data$tours.some(t=>t._id===tour._id)){setIsSaved(true);}}).catch(err=>console.error(\"Wishlist check error:\",err));},[tour._id]);const toggleWishlist=async e=>{e.preventDefault();e.stopPropagation();const token=localStorage.getItem(\"token\");try{const res=await fetch(\"\".concat(BASE_URL,\"/wishlist/toggle\"),{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:\"Bearer \".concat(token)},body:JSON.stringify({tourId:tour._id})});const data=await res.json();console.log(\"Wishlist response:\",data);// ✅ Update local state immediately\nsetIsSaved(prev=>!prev);}catch(err){console.error(\"Toggle wishlist error:\",err);}};const{_id,title,city,photo,price,featured,reviews}=tour;const{totalRating,avgRating}=calculateAvgRating(reviews);return/*#__PURE__*/_jsx(\"div\",{className:\"tour__card\",children:/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"tour__img\",children:[/*#__PURE__*/_jsx(\"img\",{src:photo,alt:\"tour-img\"}),featured&&/*#__PURE__*/_jsx(\"span\",{children:\"Featured\"})]}),/*#__PURE__*/_jsxs(CardBody,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card__top d-flex align-items-center justify-content-between\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"tour__location d-flex align-items-center gap-1\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"ri-map-pin-line\"}),\" \",city]}),/*#__PURE__*/_jsxs(\"span\",{className:\"tour__rating d-flex align-items-center gap-1\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"ri-star-fill\"}),avgRating===0?null:avgRating,totalRating===0?'Not rated':/*#__PURE__*/_jsxs(\"span\",{children:[\"(\",reviews.length,\")\"]})]})]}),/*#__PURE__*/_jsx(\"h5\",{className:\"tour__title\",children:/*#__PURE__*/_jsx(Link,{to:\"/tours/\".concat(_id),children:title})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card__bottom d-flex align-items-center justify-content-between mt-3\",children:[/*#__PURE__*/_jsxs(\"h5\",{children:[\"\\u20B9\",priceWithDiscount(tour.price,tour.discountPercent).original?\"\".concat(priceWithDiscount(tour.price,tour.discountPercent).final):\"\".concat(tour.price),\" \",/*#__PURE__*/_jsx(\"span\",{children:\"/per person\"})]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn booking__btn\",children:/*#__PURE__*/_jsx(Link,{to:\"/tours/\".concat(_id),children:\"Book Now\"})})]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn secondary__btn w-100 mt-2\",onClick:toggleWishlist,children:isSaved?\"❤️ Saved\":\"♡ Save\"})]})]})});};export default TourCard;","map":{"version":3,"names":["React","useState","useEffect","Card","CardBody","Link","calculateAvgRating","priceWithDiscount","BASE_URL","jsx","_jsx","jsxs","_jsxs","TourCard","_ref","tour","isSaved","setIsSaved","token","localStorage","getItem","fetch","concat","headers","Authorization","then","res","json","data","_data$tours","tours","some","t","_id","catch","err","console","error","toggleWishlist","e","preventDefault","stopPropagation","method","body","JSON","stringify","tourId","log","prev","title","city","photo","price","featured","reviews","totalRating","avgRating","className","children","src","alt","length","to","discountPercent","original","final","onClick"],"sources":["C:/Users/00134/Desktop/Projects/MERN Project/frontend/src/shared/TourCard.jsx"],"sourcesContent":["// import React from 'react'\n// import '../styles/tour-card.css'\n// import { Card, CardBody } from 'reactstrap'\n// import { Link } from 'react-router-dom'\n// import calculateAvgRating from '../utils/avgRating'\n// import { priceWithDiscount } from '../utils/price'\n// import { BASE_URL } from \"../utils/config\";\n\n\n// const TourCard = ({tour}) => {\n//   const toggleWishlist = async (e) => {\n//     e.preventDefault();\n//     e.stopPropagation();\n//     const token = localStorage.getItem(\"token\");\n//     try{\n//       await fetch(`${BASE_URL}/wishlist/toggle`, {\n//         method: \"POST\",\n//         headers: { \"Content-Type\":\"application/json\", Authorization: `Bearer ${token}` },\n//         body: JSON.stringify({ tourId: tour._id })\n//       });\n//       // naive UI feedback\n//       alert(\"Wishlist updated\");\n//     }catch(err){ console.error(err); }\n//   };\n//     const {_id,title,city,photo,price, featured, reviews}=tour;\n// const {totalRating,avgRating} = calculateAvgRating(reviews)\n\n//   return (\n//     <div className='tour__card'>\n//       <Card>\n//         <div className=\"tour__img\">\n//             <img src={photo} alt=\"tour-img\" />\n//             { featured && <span>Featured</span>}\n//         </div>\n//         <CardBody>\n//         <div className=\"card__top d-flex align-items-center justify-content-between\">\n//             <span className='tour__location d-flex align-items-center gap-1'>\n//             <i className=\"ri-map-pin-line\"></i> {city}\n//             </span>\n//             <span className='tour__rating d-flex align-items-center gap-1'>\n//             <i className=\"ri-star-fill\"></i>{avgRating === 0 ? null :avgRating} \n//             {totalRating === 0 ? ('Not rated'):(\n//               <span>({reviews.length})</span>\n//               )}\n            \n//             </span>\n//         </div>\n//         <h5 className='tour__title'><Link to={`/tours/${_id}`}>{title}</Link></h5>\n\n//         <div className=\"card__bottom d-flex align-items-center justify-content-between mt-3\">\n//             <h5>{priceWithDiscount(tour.price, tour.discountPercent).original ? (`${priceWithDiscount(tour.price, tour.discountPercent).final}`) : `${tour.price}`} <span>/per person</span></h5>\n//             <button className=\"btn booking__btn\">\n//                 <Link to={`/tours/${_id}`}>Book Now</Link>\n//             </button>\n//         </div>\n//       <button className=\"btn secondary__btn w-100 mt-2\" onClick={toggleWishlist}>♥ Save</button>\n// </CardBody>\n//       </Card>\n    \n//     </div>\n//   )\n// }\n\n// export default TourCard\n\nimport React, { useState, useEffect } from 'react';\nimport '../styles/tour-card.css';\nimport { Card, CardBody } from 'reactstrap';\nimport { Link } from 'react-router-dom';\nimport calculateAvgRating from '../utils/avgRating';\nimport { priceWithDiscount } from '../utils/price';\nimport { BASE_URL } from \"../utils/config\";\n\nconst TourCard = ({ tour }) => {\n  const [isSaved, setIsSaved] = useState(false);\n\n  // ✅ Check if this tour is already in wishlist when component loads\n  useEffect(() => {\n    const token = localStorage.getItem(\"token\");\n    if (!token) return;\n\n    fetch(`${BASE_URL}/wishlist`, {\n      headers: { Authorization: `Bearer ${token}` }\n    })\n      .then(res => res.json())\n      .then(data => {\n        if (data?.tours?.some(t => t._id === tour._id)) {\n          setIsSaved(true);\n        }\n      })\n      .catch(err => console.error(\"Wishlist check error:\", err));\n  }, [tour._id]);\n\n  const toggleWishlist = async (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    const token = localStorage.getItem(\"token\");\n\n    try {\n      const res = await fetch(`${BASE_URL}/wishlist/toggle`, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\", Authorization: `Bearer ${token}` },\n        body: JSON.stringify({ tourId: tour._id })\n      });\n\n      const data = await res.json();\n      console.log(\"Wishlist response:\", data);\n\n      // ✅ Update local state immediately\n      setIsSaved(prev => !prev);\n\n    } catch (err) {\n      console.error(\"Toggle wishlist error:\", err);\n    }\n  };\n\n  const { _id, title, city, photo, price, featured, reviews } = tour;\n  const { totalRating, avgRating } = calculateAvgRating(reviews);\n\n  return (\n    <div className='tour__card'>\n      <Card>\n        <div className=\"tour__img\">\n          <img src={photo} alt=\"tour-img\" />\n          {featured && <span>Featured</span>}\n        </div>\n        <CardBody>\n          <div className=\"card__top d-flex align-items-center justify-content-between\">\n            <span className='tour__location d-flex align-items-center gap-1'>\n              <i className=\"ri-map-pin-line\"></i> {city}\n            </span>\n            <span className='tour__rating d-flex align-items-center gap-1'>\n              <i className=\"ri-star-fill\"></i>{avgRating === 0 ? null : avgRating}\n              {totalRating === 0 ? ('Not rated') : (\n                <span>({reviews.length})</span>\n              )}\n            </span>\n          </div>\n          <h5 className='tour__title'><Link to={`/tours/${_id}`}>{title}</Link></h5>\n\n          <div className=\"card__bottom d-flex align-items-center justify-content-between mt-3\">\n            <h5>₹\n              {priceWithDiscount(tour.price, tour.discountPercent).original\n                ? (`${priceWithDiscount(tour.price, tour.discountPercent).final}`)\n                : `${tour.price}`} <span>/per person</span>\n            </h5>\n            <button className=\"btn booking__btn\">\n              <Link to={`/tours/${_id}`}>Book Now</Link>\n            </button>\n          </div>\n\n          {/* ✅ Button updates dynamically */}\n          <button className=\"btn secondary__btn w-100 mt-2\" onClick={toggleWishlist}>\n            {isSaved ? \"❤️ Saved\" : \"♡ Save\"}\n          </button>\n        </CardBody>\n      </Card>\n    </div>\n  );\n};\n\nexport default TourCard;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}