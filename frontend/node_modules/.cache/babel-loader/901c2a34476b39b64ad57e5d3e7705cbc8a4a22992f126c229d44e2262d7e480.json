{"ast":null,"code":"import _objectSpread from\"C:/Users/00134/Desktop/Contents/MERN/PROJECT/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useContext}from'react';import'./booking.css';import{Button,Form,FormGroup,ListGroup,ListGroupItem}from'reactstrap';import{useNavigate}from'react-router-dom';import{AuthContext}from'../../context/AuthContext';import{BASE_URL}from'../../utils/config';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Booking=_ref=>{let{tour,avgRating}=_ref;const{price,reviews,title}=tour;const navigate=useNavigate();const{user}=useContext(AuthContext);const[booking,setBooking]=useState({userId:user&&user._id,//later it will be dynamic\nuserEmail:user&&user.email,tourName:title,fullName:'',phone:'',guestSize:1,bookAt:''});const handleChange=e=>{setBooking(prev=>_objectSpread(_objectSpread({},prev),{},{[e.target.id]:e.target.value}));};const serviceFee=10;const totalCost=Number(price)*Number(booking.guestSize)+Number(serviceFee);const percost=totalCost-serviceFee;const handleClick=async e=>{e.preventDefault();console.log(booking);console.log(\"Posting booking to:\",\"\".concat(BASE_URL,\"/booking\"));try{if(!user||user===null){return alert('Please sign in');}const token=localStorage.getItem(\"token\");if(!token){return alert(\"Please sign in first\");}const res=await fetch(\"\".concat(BASE_URL,\"/booking\"),{method:'post',headers:{'Content-Type':'application/json','Authorization':\"Bearer \".concat(token)},credentials:'include',body:JSON.stringify(booking)});const result=await res.json();if(!res.ok){return alert(result.message);}navigate('/thank-you');}catch(err){alert(err.message);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"booking\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\" booking__top d-flex align-items-center justify-content-between\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"\\u20B9\",price,/*#__PURE__*/_jsx(\"span\",{children:\"/per person\"})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"tour__rating d-flex align-items-center \",children:[/*#__PURE__*/_jsx(\"i\",{className:\"ri-star-fill\"}),avgRating===0?null:avgRating,\" (\",reviews===null||reviews===void 0?void 0:reviews.length,\")\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"booking__form\",children:[/*#__PURE__*/_jsx(\"h5\",{children:\"Information\"}),/*#__PURE__*/_jsxs(Form,{className:\"booking__info-form\",onSubmit:handleClick,children:[/*#__PURE__*/_jsx(FormGroup,{children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Full Name\",id:\"fullName\",required:true,onChange:handleChange})}),/*#__PURE__*/_jsx(FormGroup,{children:/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"Phone\",id:\"phone\",required:true,onChange:handleChange})}),/*#__PURE__*/_jsxs(FormGroup,{className:\"d-flex align-items-center gap-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"date\",placeholder:\"\",id:\"bookAt\",required:true,onChange:handleChange}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"Guest\",id:\"guestSize\",required:true,onChange:handleChange})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"booking__bottom\",children:[/*#__PURE__*/_jsxs(ListGroup,{children:[/*#__PURE__*/_jsxs(ListGroupItem,{className:\"border-0 px-0\",children:[/*#__PURE__*/_jsxs(\"h5\",{className:\"d-flex align-items-center gap-1\",children:[\"\\u20B9\",price,/*#__PURE__*/_jsx(\"i\",{className:\"ri-close-line\"}),booking.guestSize]}),/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u20B9\",percost]})]}),/*#__PURE__*/_jsxs(ListGroupItem,{className:\"border-0 px-0\",children:[/*#__PURE__*/_jsx(\"h5\",{children:\"Service charge\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u20B9\",serviceFee]})]}),/*#__PURE__*/_jsxs(ListGroupItem,{className:\"border-0 px-0 total\",children:[/*#__PURE__*/_jsx(\"h5\",{children:\"Total\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"\\u20B9\",totalCost]})]})]}),/*#__PURE__*/_jsx(Button,{className:\"btn primary__btn w-100 mt-4\",onClick:handleClick,children:\"Book Now\"})]})]});};export default Booking;","map":{"version":3,"names":["React","useState","useContext","Button","Form","FormGroup","ListGroup","ListGroupItem","useNavigate","AuthContext","BASE_URL","jsx","_jsx","jsxs","_jsxs","Booking","_ref","tour","avgRating","price","reviews","title","navigate","user","booking","setBooking","userId","_id","userEmail","email","tourName","fullName","phone","guestSize","bookAt","handleChange","e","prev","_objectSpread","target","id","value","serviceFee","totalCost","Number","percost","handleClick","preventDefault","console","log","concat","alert","token","localStorage","getItem","res","fetch","method","headers","credentials","body","JSON","stringify","result","json","ok","message","err","className","children","length","onSubmit","type","placeholder","required","onChange","onClick"],"sources":["C:/Users/00134/Desktop/Contents/MERN/PROJECT/frontend/src/components/Booking/Booking.jsx"],"sourcesContent":["import React, { useState ,useContext} from 'react'\nimport './booking.css'\nimport { Button, Form, FormGroup,ListGroup,ListGroupItem } from 'reactstrap'\nimport { useNavigate } from 'react-router-dom';\nimport { AuthContext } from '../../context/AuthContext';\nimport { BASE_URL } from '../../utils/config';\n\nconst Booking = ({tour, avgRating}) => {\n    const{price,reviews,title}= tour;\n    const navigate = useNavigate();\n\n    const {user} = useContext(AuthContext)\n\n    const [booking,setBooking]= useState({\n        userId: user && user._id, //later it will be dynamic\n        userEmail: user && user.email,\n        tourName:title,\n        fullName:'',\n        phone:'',\n        guestSize:1,\n        bookAt:''\n    })\n    const handleChange = e =>{\n        setBooking(prev=>({...prev,[e.target.id]:e.target.value}))\n    };\n\n    const serviceFee =10\n    const totalCost = \n    Number(price) * Number(booking.guestSize) + Number(serviceFee)\n    const percost=totalCost-serviceFee\n    \n    const handleClick = async e =>{\n        e.preventDefault();\n\n        console.log(booking);\n        console.log(\"Posting booking to:\", `${BASE_URL}/booking`);\n\n\n        try {\n            if(!user || user===null){\n                return alert('Please sign in')\n            }\n\n            const token = localStorage.getItem(\"token\");\n            if (!token) {\n                return alert(\"Please sign in first\");\n                }\n           \n            const res = await fetch(`${BASE_URL}/booking`,{\n\n                method:'post',\n                headers:{\n                    'Content-Type':'application/json',\n                    'Authorization': `Bearer ${token}`\n                },\n                credentials:'include',\n                body:JSON.stringify(booking)\n            })\n            const result = await res.json()\n\n            if(!res.ok){\n                return alert(result.message)\n            }\n            navigate('/thank-you')\n\n        } catch (err) {\n            alert(err.message)\n        }\n\n      \n        \n    }\n\n  return (\n   <div className=\"booking\">\n    <div  className=\" booking__top d-flex align-items-center\n     justify-content-between\">\n        <h3>₹{price}<span>/per person</span></h3>\n        <span className='tour__rating d-flex align-items-center '>\n                      <i className=\"ri-star-fill\"></i>\n                      {avgRating === 0 ? null : avgRating} ({reviews?.length})\n                    </span>\n    </ div>\n\n    <div className=\"booking__form\">\n        <h5>Information</h5>\n        <Form className=\"booking__info-form\" onSubmit={handleClick}>\n        <FormGroup>\n            <input type=\"text\" placeholder='Full Name' \n            id='fullName' required onChange={handleChange} />\n        </FormGroup>\n        <FormGroup>\n            <input type=\"number\" placeholder='Phone' \n            id='phone' required onChange={handleChange} />\n        </FormGroup>\n        <FormGroup className='d-flex align-items-center gap-3'>\n            <input type=\"date\" placeholder='' \n            id='bookAt' required onChange={handleChange} />\n            <input type=\"number\" placeholder='Guest' \n            id='guestSize' required onChange={handleChange} />\n        </FormGroup>\n        </Form>\n    </div>\n\n\n<div className=\"booking__bottom\">\n    <ListGroup>\n    <ListGroupItem className=\"border-0 px-0\">\n        <h5 className='d-flex align-items-center gap-1'>\n            ₹{price}<i className=\"ri-close-line\"></i>{booking.guestSize}\n        </h5>\n        <span>₹{percost}</span>\n    </ListGroupItem>\n    <ListGroupItem className=\"border-0 px-0\">\n        <h5>Service charge</h5>\n        <span>₹{serviceFee}</span>\n    </ListGroupItem>\n    <ListGroupItem className=\"border-0 px-0 total\">\n        <h5>Total</h5>\n        <span>₹{totalCost}</span>\n    </ListGroupItem>\n    </ListGroup>\n<Button className=\"btn primary__btn w-100 mt-4\" onClick={handleClick}>Book Now</Button>\n</div>\n   </div>\n  )\n}\n\nexport default Booking\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}